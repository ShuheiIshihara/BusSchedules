# 次期実装タスク一覧

## 現状
✅ 基本的な画面遷移と時刻表表示機能が完成
✅ テストデータによる動作確認済み

## 実装完了済み機能
- ✅ 駅選択 → 検索ボタン → 時刻表表示の画面遷移
- ✅ 時刻表リストの表示（発車時刻、路線名、行先、のりば）
- ✅ リアルタイム現在時刻表示（HH:MM:SS）
- ✅ 過去時刻のグレーアウト機能
- ✅ 戻るボタンでの駅選択画面への復帰
- ✅ タブUI（平日/土日祝、行き/帰り）
- ✅ タップして詳細表示機能（基本UI）

## 次に実装すべき項目

### 優先度 High

#### 1. 実際のデータベース連携
- **SupabaseService.getBusSchedules のJSON解析処理**
  - 現在: テストデータ返却（モック実装）
  - 要対応: RPC関数 `get_phase1_bus_schedule` レスポンス解析
  - BusScheduleData配列への変換処理実装
  - 実装ファイル: `20_Source/BusNow/BusNow/Services/SupabaseService.swift:83-113`

- **エラーハンドリングの強化**
  - データベース接続失敗時の適切なエラー表示
  - ネットワークエラー・タイムアウト対応
  - リトライ機能の実装

#### 2. サービスタイプ判定の実装
- **平日/土日祝の自動判定**
  - 現在: UI切り替えは可能だがデータ取得に反映されていない
  - 要対応: カレンダー情報による運行パターン判定
  - 祝日データベースとの連携

### 優先度 Medium

#### 3. UI機能の完成
- **のりばボタン機能**
  - 近接情報WebView表示機能
  - モーダル表示とWebView実装
  - 実装ファイル: `20_Source/BusNow/BusNow/Views/Schedule/BusScheduleView.swift:285`

- **詳細表示内容の充実**
  - 現在: 展開可能だが詳細情報が空
  - 要対応: バス遅延情報、運行状況、乗車位置情報等

#### 4. UX改善
- **ローディング状態の詳細化**
  - データ取得中の進捗表示
  - スケルトン画面の実装

- **データキャッシュ機能**
  - 同じ検索条件での再取得回避
  - ローカルストレージ活用

### 優先度 Low

#### 5. パフォーマンス最適化
- **画面遷移のアニメーション**
- **メモリ使用量の最適化**
- **バックグラウンド更新機能**

#### 6. 追加機能
- **お気に入り路線機能**
- **プッシュ通知機能**
- **オフラインモード対応**

## 実装順序推奨

### Phase 1: データベース連携完成（最優先）
1. JSON解析処理の実装
2. エラーハンドリング強化
3. サービスタイプ判定実装

### Phase 2: UI機能完成
1. のりばボタン機能
2. 詳細表示内容充実

### Phase 3: UX改善
1. ローディング状態改善
2. データキャッシュ機能

### Phase 4: 追加機能・最適化
1. パフォーマンス最適化
2. 追加機能実装

## 備考
- テストデータによる動作確認により、基本的な画面フローとUI機能が正常に動作することを確認済み
- 次の最重要タスクは実際のデータベースからのデータ取得処理の実装