# 駅選択画面 - 画面設計書

## 1. 画面概要

**画面名**: 駅選択画面 (StationSelectionView)  
**目的**: ユーザーが出発駅と到着駅を入力し、バス時刻表検索のための駅ペアを設定する  
**表示タイミング**: アプリ起動時の初回画面

---

## 2. ワイヤーフレーム

```
┌─────────────────────────────────────────┐
│               ← 駅の選択                  │
├─────────────────────────────────────────┤
│                                         │
│  出発駅                                  │
│ ┌─────────────────────────────────────┐ │
│ │  乗車駅を入力してください              │ │
│ └─────────────────────────────────────┘ │
│                                         │
│  到着駅                                  │
│ ┌─────────────────────────────────────┐ │
│ │  降車駅を入力してください              │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │             確定                      │ │
│ └─────────────────────────────────────┘ │
│                                         │
│  検索履歴                        クリア  │
│ ┌─────────────────────────────────────┐ │
│ │  新宿駅 → 渋谷駅           8/28 14:30 │ │
│ ├─────────────────────────────────────┤ │
│ │  池袋駅 → 上野駅           8/27 09:15 │ │
│ ├─────────────────────────────────────┤ │
│ │  東京駅 → 品川駅           8/26 18:45 │ │
│ └─────────────────────────────────────┘ │
│                                         │
│                                         │
└─────────────────────────────────────────┘
```

---

## 3. 画面構成要素

### 3.1 ヘッダー
- **ナビゲーションタイトル**: 「駅の選択」
- **戻るボタン**: なし（初回画面のため）

### 3.2 入力セクション

#### 3.2.1 出発駅入力
- **ラベル**: 「出発駅」
- **入力フィールド**: 
  - プレースホルダー: 「乗車駅を入力してください」
  - スタイル: 角丸ボーダー
  - 必須入力項目

#### 3.2.2 到着駅入力  
- **ラベル**: 「到着駅」
- **入力フィールド**:
  - プレースホルダー: 「降車駅を入力してください」
  - スタイル: 角丸ボーダー
  - 必須入力項目

### 3.3 アクションセクション

#### 3.3.1 確定ボタン
- **テキスト**: 「確定」
- **スタイル**: プライマリボタン（青色背景、白文字）
- **幅**: 画面幅いっぱい
- **状態**:
  - 有効: 両方の駅名が入力済み
  - 無効: どちらかの駅名が空の場合（グレーアウト）

### 3.4 履歴セクション

#### 3.4.1 セクションヘッダー
- **左側**: 「検索履歴」ラベル
- **右側**: 「クリア」ボタン（小さいフォント）

#### 3.4.2 履歴リスト
- **表示条件**: 履歴データが存在する場合のみ表示
- **最大表示件数**: 10件
- **各履歴項目**:
  - **左側**: 駅名ペア（例: 「新宿駅 → 渋谷駅」）
  - **右側**: 検索日時（例: 「8/28 14:30」）
  - **フォント**: 日時は小さいフォント、グレー色
  - **操作**: タップで入力フィールドに自動入力

---

## 4. インタラクション

### 4.1 ユーザー操作フロー
1. **起動時**: 前回保存された駅名を自動表示（存在する場合）
2. **入力**: 出発駅・到着駅を手動入力
3. **履歴選択**: 履歴項目をタップして自動入力（オプション）
4. **確定**: ボタンタップでメイン画面へ遷移

### 4.2 状態管理
- **保存タイミング**: 確定ボタン押下時
- **履歴更新**: 確定時に履歴リストの先頭に追加
- **重複処理**: 同じ駅ペアの場合、既存項目を削除して最新を先頭に追加

### 4.3 データ永続化
- **保存場所**: UserDefaults
- **保存データ**:
  - 現在の駅ペア: 単一オブジェクト
  - 検索履歴: 配列（最大10件）

---

## 5. レスポンシブ設計

### 5.1 画面サイズ対応
- **Form**: iOS標準のフォームレイアウトで自動調整
- **入力フィールド**: 画面幅に応じて自動調整
- **ボタン**: 画面幅いっぱいに拡張

### 5.2 フォント・カラー
- **ヘッダー**: システム標準フォント
- **入力フィールド**: システム標準フォント
- **履歴日時**: キャプションフォント、セカンダリーカラー
- **確定ボタン**: 白文字、プライマリーカラー背景

---

## 6. アクセシビリティ

### 6.1 VoiceOver対応
- 各入力フィールドにアクセシビリティラベル設定済み
- ボタンの状態（有効/無効）を音声で通知

### 6.2 キーボードナビゲーション
- Tab順序: 出発駅 → 到着駅 → 確定ボタン
- Return キーで次のフィールドへフォーカス移動

---

## 7. 技術実装詳細

### 7.1 使用コンポーネント
- **NavigationView**: 画面全体のナビゲーション構造
- **Form**: iOS標準のフォームレイアウト
- **TextField**: 駅名入力フィールド
- **Button**: 確定ボタンおよび履歴選択
- **Section**: フォーム内のセクション分け

### 7.2 データモデル
```swift
struct StationPair: Codable, Equatable, Identifiable {
    let id = UUID()
    let departureStation: String
    let arrivalStation: String
    let createdAt: Date
}
```

### 7.3 ViewModel機能
- 駅ペアの保存・読み込み
- 検索履歴の管理（追加・削除・重複処理）
- UserDefaultsによるデータ永続化